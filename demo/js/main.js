// Generated by CoffeeScript 1.8.0
(function() {
  var Body, Force, M, N, PI, SE2, Solver, TBS, abs, atan2, cos, runWorld, sin, spring, sqrt, _ref;

  N = numeric;

  _ref = M = Math, abs = _ref.abs, sin = _ref.sin, cos = _ref.cos, atan2 = _ref.atan2, sqrt = _ref.sqrt, PI = _ref.PI;

  Force = yaya.Force, SE2 = yaya.SE2, Body = yaya.Body, Solver = yaya.Solver;

  spring = function(k, d0) {
    return function(t) {
      var d, v;
      v = this.bodyN.frame.pos.minus(this.bodyP.frame.pos);
      v.th = 0;
      d = N.norm2([v.x, v.y]);
      d = M.max(d, 1e3 * N.epsilon);
      return new Force(v.scale(k * (1 - d0 / d)));
    };
  };

  TBS = function() {
    var b1, b2, w;
    w = new yaya('#main', {
      spaceScale: 200
    });
    b1 = w.addBody('b1', new Body(1, 1, {
      pos: SE2(1, 1, 0)
    }), 'M 0 50 L -25 0 25 0 Z');
    b2 = w.addBody('b2', new Body(2, 1, {
      pos: SE2(2, 3, 0)
    }), 'M 100 0 Q 0 50 -100 0 Q 0 -50 100 0');
    w.forceFuncs.add(b1, b2, spring(1, 1));
    return w;
  };

  runWorld = function(w, duration) {
    var handler, ms0, ms1;
    w.solver = Solver.verletFixed;
    w._getAcc(0);
    ms0 = null;
    ms1 = null;
    return window.requestAnimationFrame(handler = function(ms) {
      if (ms0 == null) {
        ms0 = ms;
        ms1 = ms + duration;
      }
      console.log(ms);
      w.update(ms);
      if (ms < ms1) {
        return window.requestAnimationFrame(handler);
      }
    });
  };

  runWorld(TBS(), 10000);

}).call(this);

//# sourceMappingURL=main.js.map
